{"expireTime":9007200845574950000,"key":"transformer-remark-markdown-html-ast-a75f799be1fb40b8a41f82862f744bc5-gatsby-plugin-sharpgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-emojis-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"こんばんは。\n上島珈琲は連休最後の夜でもみんな作業しまくっててびっくりしていますが、みんなMacで何してるんだろう。","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":4,"column":52,"offset":60}}}],"position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":4,"column":52,"offset":60}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"今回は、","position":{"start":{"line":6,"column":1,"offset":62},"end":{"line":6,"column":5,"offset":66}}},{"type":"element","tagName":"a","properties":{"href":"http://techeten.xyz/10305"},"children":[{"type":"text","value":"前回のIstio記事","position":{"start":{"line":6,"column":6,"offset":67},"end":{"line":6,"column":16,"offset":77}}}],"position":{"start":{"line":6,"column":5,"offset":66},"end":{"line":6,"column":44,"offset":105}}},{"type":"text","value":"の構成について思っていた疑問点を、GoogleNextにせっかく参加したので聞いてみましたという記事です。","position":{"start":{"line":6,"column":44,"offset":105},"end":{"line":6,"column":97,"offset":158}}}],"position":{"start":{"line":6,"column":1,"offset":62},"end":{"line":6,"column":97,"offset":158}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"前回構成の疑問点","position":{"start":{"line":8,"column":5,"offset":164},"end":{"line":8,"column":13,"offset":172}}}],"position":{"start":{"line":8,"column":1,"offset":160},"end":{"line":8,"column":13,"offset":172}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"前回の構成図は下記のようなものでした。","position":{"start":{"line":10,"column":1,"offset":174},"end":{"line":10,"column":20,"offset":193}}}],"position":{"start":{"line":10,"column":1,"offset":174},"end":{"line":10,"column":20,"offset":193}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"http://techeten.xyz/wp-content/uploads/2018/09/istio-blog-1.png"},"children":[{"type":"element","tagName":"img","properties":{"src":"http://techeten.xyz/wp-content/uploads/2018/09/istio-blog-1-580x325.png","alt":null},"children":[],"position":{"start":{"line":12,"column":2,"offset":196},"end":{"line":12,"column":78,"offset":272}}}],"position":{"start":{"line":12,"column":1,"offset":195},"end":{"line":12,"column":144,"offset":338}}}],"position":{"start":{"line":12,"column":1,"offset":195},"end":{"line":12,"column":144,"offset":338}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"これにて一見落着っぽいのですが、\nふと「あれ、これマルチクラスタとかできないのでは？」","position":{"start":{"line":14,"column":1,"offset":340},"end":{"line":15,"column":27,"offset":383}}}],"position":{"start":{"line":14,"column":1,"offset":340},"end":{"line":15,"column":27,"offset":383}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Regional IPをそのまま　istio-ingressgatewayのserviceに紐づけてしまったので、\nIstioを使うためにはマルチクラスタ構成ができないのか…？GCLB使いたいときは…？","position":{"start":{"line":17,"column":1,"offset":385},"end":{"line":18,"column":44,"offset":486}}}],"position":{"start":{"line":17,"column":1,"offset":385},"end":{"line":18,"column":44,"offset":486}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"これが疑問点でした。","position":{"start":{"line":20,"column":1,"offset":488},"end":{"line":20,"column":11,"offset":498}}}],"position":{"start":{"line":20,"column":1,"offset":488},"end":{"line":20,"column":11,"offset":498}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"The Expert Response","position":{"start":{"line":22,"column":5,"offset":504},"end":{"line":22,"column":24,"offset":523}}}],"position":{"start":{"line":22,"column":1,"offset":500},"end":{"line":22,"column":24,"offset":523}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ask the Expertブースにはかの有名なイアン氏がいたので（日本語ペラペラ）、聞いてみました。\nIstioはあまり把握していないとのことだったのですが、\n「istio-ingressgatewayもserviceなのだから、LoadBalancerIPでexposeするのでなく、NodePortで公開してしまって、GCLBからはGKEのinstance groupに対してトラフィックを流せばいいのでは？」とのこと。\nズバリ下記構成です(podは省略)。","position":{"start":{"line":24,"column":1,"offset":525},"end":{"line":27,"column":19,"offset":757}}}],"position":{"start":{"line":24,"column":1,"offset":525},"end":{"line":27,"column":19,"offset":757}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"http://techeten.xyz/wp-content/uploads/2018/09/stio-blog-2.png"},"children":[{"type":"element","tagName":"img","properties":{"src":"http://techeten.xyz/wp-content/uploads/2018/09/stio-blog-2-580x354.png","alt":null},"children":[],"position":{"start":{"line":29,"column":2,"offset":760},"end":{"line":29,"column":77,"offset":835}}}],"position":{"start":{"line":29,"column":1,"offset":759},"end":{"line":29,"column":142,"offset":900}}}],"position":{"start":{"line":29,"column":1,"offset":759},"end":{"line":29,"column":142,"offset":900}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"た、たしかに。\nIstioの公式にも、istio-ingressgatewayをそのまま公開すべし、といった話はなく、NodePort使う場合には？みたいな説明もありました。\n","position":{"start":{"line":31,"column":1,"offset":902},"end":{"line":33,"column":1,"offset":990}}},{"type":"element","tagName":"a","properties":{"href":"https://istio.io/docs/tasks/traffic-management/ingress/#determining-the-ingress-ip-and-ports-when-using-a-node-port"},"children":[{"type":"text","value":"https://istio.io/docs/tasks/traffic-management/ingress/#determining-the-ingress-ip-and-ports-when-using-a-node-port","position":{"start":{"line":33,"column":1,"offset":990},"end":{"line":33,"column":116,"offset":1105}}}],"position":{"start":{"line":33,"column":1,"offset":990},"end":{"line":33,"column":116,"offset":1105}}}],"position":{"start":{"line":31,"column":1,"offset":902},"end":{"line":33,"column":116,"offset":1105}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"まだ試してませんが、こうすればGlobal IPも使えるし、マルチクラスタもできそうです。\nどのみち既存構成からダウンタイムなしでIstio化することはなかなか難しそうではありますが。","position":{"start":{"line":35,"column":1,"offset":1107},"end":{"line":36,"column":47,"offset":1199}}}],"position":{"start":{"line":35,"column":1,"offset":1107},"end":{"line":36,"column":47,"offset":1199}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ただ、GKEをそこそこ長く運用してきてわかったことの一つに、障害頻度としてはGCLB　> GKEという問題があります。\nそして世界中からの分散トラフィックがくる状況下になければ、マルチクラスタする旨みもどうなんだろう感。\n悩ましいですね！以上です。","position":{"start":{"line":38,"column":1,"offset":1201},"end":{"line":40,"column":14,"offset":1325}}}],"position":{"start":{"line":38,"column":1,"offset":1201},"end":{"line":40,"column":14,"offset":1325}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":40,"column":14,"offset":1325}}}}