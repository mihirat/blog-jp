{"expireTime":9007200845577683000,"key":"transformer-remark-markdown-html-bb4909b762fbe62f7fa1a40be985d850-gatsby-plugin-sharpgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-emojis-","val":"<h2>あらすじ</h2>\n<p>暑くてめちゃめちゃ目が覚める。</p>\n<p>エアコンつけっぱなしだと眠りがなぜか浅く、スッキリしない。</p>\n<p>しかし扇風機だと暑さに負けてやはり眠りが浅い。</p>\n<p>そこでエアコンの電源予約offを使っても、エアコン切ったあとの温度上昇でまた起きる…</p>\n<p>エアコンをつけっぱなしにせずに、一定の温度を保つ方法…自動制御しかない！！</p>\n<h2>やりたいこと</h2>\n<p>一定の温度以上になったらエアコンの電源が入り、一定の温度以下になったらエアコンの電源が切れるようにしたい。</p>\n<h2>作業記録</h2>\n<h3>使ったもの</h3>\n<ul>\n<li>家にあったraspberry pi 2</li>\n<li>家にあった赤外線受光モジュール、抵抗、\b赤外線送信LED、ブレッドボードなど</li>\n</ul>\n<h3>1.raspberry pi 2をセットアップ</h3>\n<p>一人暮らし始めてから触ってなかったので、とりあえず</p>\n<pre class=\"lang:shell decode:true \" title=\"shell\">$ sudo apt-get update && sudo apt-get upgrade &&sudo rpi-update\n$ sudo reboot\n</pre>\n<p>をしたら、久しぶりすぎたせいかraspiに電源が入らなくなった。のでやむを得ずraspbianの最新版をダウンロードします。\nすると <code class=\"language-text\">sudo apt-get upgrade</code> ができない！\ndpkgに問題があるのだが、<a href=\"https://www.raspberrypi.org/forums/viewtopic.php?t=187936&#x26;p=1186861\">07-05リリースに原因がある</a>っぽいので06-21版をインストールして解決しました。ここまで2時間…\n参考：\n<a href=\"http://qiita.com/kozykana/items/df6aa52cbb8917abc268\">Raspberry Pi 2の初期設定(外付けモニタ・USBキーボードなし、OS:Raspbian)</a></p>\n<h3>2. 回路をもとに部品を配置</h3>\n<p>昔買った↓を参考に部品を設置して回路を作ります。\n<a href=\"https://www.amazon.co.jp/gp/product/4822224953/ref=as_li_tl?ie=UTF8&#x26;camp=247&#x26;creative=1211&#x26;creativeASIN=4822224953&#x26;linkCode=as2&#x26;tag=techeten02-22&#x26;linkId=179efe53711f7da473b78ff3d2b606c1\"><img src=\"//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&#x26;MarketPlace=JP&#x26;ASIN=4822224953&#x26;ServiceVersion=20070822&#x26;ID=AsinImage&#x26;WS=1&#x26;Format=_SL250_&#x26;tag=techeten02-22\"></a><img src=\"//ir-jp.amazon-adsystem.com/e/ir?t=techeten02-22&#x26;l=am2&#x26;o=9&#x26;a=4822224953\"></p>\n<p>完成したのがこんな感じ\n<a href=\"http://techeten.xyz/wp-content/uploads/2017/07/CSt_uTJUsAAaTt9.jpg\"><img src=\"http://techeten.xyz/wp-content/uploads/2017/07/CSt_uTJUsAAaTt9-580x326.jpg\"></a></p>\n<h3>3. lircの設定</h3>\n<pre class=\"lang:shell decode:true \" title=\"shell\">$ sudo apt-get install lirc\n</pre>\n<p>してから、lircの設定をする。\n<a href=\"http://tiger-star.net/aquarium/goldfish/321\">Raspberry Pi2でリモコンを使って水槽の照明をつける</a>が大変詳しいです。\nリモコンがちゃんと受信できてるかもチェック。</p>\n<h3>4. リモコンの学習</h3>\n<p>lircのirrcordだとリモコンの信号は複雑過ぎて学習できないらしいので、生の信号を書き出してからlircで使える形に変換します。\n<a href=\"http://kaiware007.hatenablog.jp/entry/2015/08/28/020356\">Raspberry Pi 2 でエアコン操作（赤外線リモコン編）</a>がめっちゃ素晴らしいです。</p>\n<pre class=\"lang:shell decode:true \" title=\"shell\">$ sudo /etc/init.d/lirc start\n$ irsend SEND_ONCE aircon on\n</pre>\n<p>これでピピ！ってなったときの嬉しさ！ここまで4時間</p>\n<h3>5. 自動化</h3>\n<p>ほんとは室温取ってきてちゃんと制御したいんですが、最低限on offが自動で動いてくれればいいんで</p>\n<pre class=\"lang:shell decode:true \" title=\"autocon.sh\">morning=8\nwhile true\ndo\n  irsend SEND_ONCE aircon on\n  sleep 3600\n  irsend SEND_ONCE aircon off\n  sleep 3600\n  hour=$(date '+%H')\n  if [ $hour -gt $morning ]; then\n    break\n  fi\ndone\n</pre>\n<p>くらい書いてゴール！！！\n1時間エアコンつけて、1時間エアコン切ってを繰り返すスクリプトです。</p>\n<p>あとは就寝前(morning判定は22時より後に就寝するなら問題ない)に <code class=\"language-text\">. autocon.sh</code> すればok。</p>\n<p>これで明日から不眠解消！素人でもお手軽おうちハック。</p>"}